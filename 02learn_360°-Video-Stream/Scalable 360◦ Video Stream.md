# **Scalable 360***◦*** Video Stream**

## 1. Introduction

###  (1) What makes panoramic video rise up?
[表格]
- VR & AR 逐渐兴起，硬件设备的更新比如Oculus Rift或HTC Vive，更多的头戴设备于智能手机和PC端相连，提高消费者购买欲望。
- 全景相机的可用性，比如：GoPro OmniAll和Insta360 One。
- 社交 / 视频平台支持全景视频的发布

### (2) The difficulties of the panoramic video.
[表格]
- 带宽要求高，相比于传统2D视频的 **25 Mb/s**，全景视频需要**400 Mb/s**的带宽支持。

- 全景视频需要**更大的存储空间**（1. 一个场景的多个视图 2. 为了适应不同客户端需要不同格式和分辨率的视频文件 3. 需要自适应率来支持自适应率ABR比特流），大概90mins的视频需要270Gb的存储空间。

- 当用户转头时，渲染新视图的**延迟应该不超过几十毫秒**来防止晕头。

- 复杂的视图适应，想适应用户的头部移动所需视频视角有两种解决方法：
  1. 将完整的全景图都下载到客户端，但是会导致浪费。

  2. 将全景视频分成几个贴图的区域，难点1. **预测用户的移动**  2. 使用**自适应控制缓冲区**，需要创新的算法和架构来做出智能决策来存储、缓存和预取内容以便于**执行无缝的视图/比特率调整**的。
     ![image-20210108090434128](https://littlefisher.oss-cn-beijing.aliyuncs.com/images/image-20210108090434128.png)
  3. 用户看到的贴图应该已经被预取到**近端边缘服务器甚至客户端缓冲区**中，以便能够快速渲染。

- 虽然用户可以全方位转头，但是导演更想让用户按照他的设定，于是在数据中编码导演的规则额外复杂。

## 2. 概念综述

### (1) 捕获视频，编码，存储的数据模型

- 视频是由一个**中心摄像机系统**捕获的，已有的**全向视频编码技术**和**分层编码技术**可以适应视角的变化。
  ![image-20210108090449538](https://littlefisher.oss-cn-beijing.aliyuncs.com/images/image-20210108090449538.png)

### (2) 全景视频的架构

高质量的全景视频架构是基于现有CDN架构的基础上的，架构分为**创建**，**传输**和**边缘交付**。

## 3. 内容创造（视频的表征）

- 一个潜在的表示形式是：基于HTTP的MPEG动态自适应流(DASH)，它代表每个摄像机的内容流，因此为k个分布式的2-D摄像机环境生成k个独立的MPEG-DASH视流。
- 同时还可以将视频设备配置在一起后缝合内容。

### (1) MPEG - DASH 视频表示

- 用户请求观看视频时，都将首先请求包含媒体内容的时空信息的MPD，并基于该信息，它将请求最适合其需求的各个细分（高，中，低质量）。其中的MPD文件是包含很多组件的层次数据模型，清单文件。
- MPEG发布了一个全方位媒体应用程序格式的草案。该格式指定了一组投影映射转换**360◦视频到二维平面**。此外，它指定了在ISO基本媒体的**全景视频的存储格式**，以及**在DASH上的封装和指令**，以及可以变成全景视频的标准。

### (2) 全景视频的放映和流媒体的准备
[表格]

- 由于现有编码不支持球鞋视频的编码，我们需要将球形视频以不同的方法投影到二维平面上。方法有1. Equirectangular，2. cubemap，3.  pyramid projection（其中第2种比第1种所需文件少了25%，第3种可以减小80%的文件大小，但是会影响质量同时需要GPU处理）
- 视频流的启动：每张贴图都有低中高的质量，客户端根据用户在空间域内的视口来调整视频质量，进行两项调整：
  1. 速率调整以适应时变带宽
  2. 视口调整以适应用户的头部运动
- 另一种方法是预测用户下一次的运动趋势，以便提前加载。但是不仅需要有多个解码器，还有以下三点困难：
  1. VR的运动到光子延迟要求小于20 ms，比Internet请求-应答延迟要小。因此需要提前3s预测。
  2. 在较小的回放缓冲区下进行延迟和暂停，这是因为基于时间的方法保持较小的回放缓冲区，以帮助解决视口预测的短期约束。(没懂)
  3. 混合码率片的边界效应，这是由于视频的空间分割而产生的。当视频块用不同的比特率编码时，这些混合比特率的图像块会在组合图像块渲染时导致可见边框和质量不一致。
  
  另一种选择是为每个视频块独立创建视口自适应表示。这需要定义一组用户感兴趣的重叠视图。然后，对于每个预定义的视角，将获取包括视口在内的整个球面帧，并在预定义视口内提供更高的质量，而在帧的其余部分提供较低的质量。Facebook和Pixvana采用了自适应360视频流的这种表示和方法。Facebook将360度视频转换成依赖视口的多分辨率全景图，这在不降低视口质量的情况下降低了整体分辨率。在这种情况下，覆盖360度视频的30个不同的视口被创建，视口间距为30。这种方法的主要优点是可以用一个解码器对视频进行解码。与基于瓦片的方法相比，整个球面框架的数据传输是有效的。这可能会增加这种方法的存储和带宽需求。

### (3) 电影的规则 (N

- 在对话过程中，摄像机视图应该保持在180行，从而保持两个或更多角色在屏幕上的相同位置。360视频内容的个性化控制是一项传统视频所没有的新功能，因此360视频传输系统也利用这些规则来最大化观看质量将是非常重要的。
- 即一个新的场景(在场景更改之后)从一个观察者最有可能选择的视图开始。这有助于视频播放器决定哪些瓷砖的360◦视频应该在一个高质量的缓冲，哪些不是。显然，这限制了观众观看的灵活性

### (4) 录像与存储 (N

360视频录制和存储系统必须考虑两个主要问题

- 生成控制元数据来描述存储在视频片段中的媒体
- 在存储云中连续捕捉和存储视频片段。（这些元数据提供了诸如段长度和每个段的质量级别等信息）
- 此外，大规模的map-reduce存储系统，包括Hadoop分布式文件系统[62]和谷歌文件系统[63]，都是可用的，但扔需要重新访问可用的存储系统，并考虑新的架构。



## 4. 视频传输

目标是**减少**必须从源端传输到边缘服务器和客户端的**数据量**，同时保持客户端的感知**质量高**和运动到光子的**延迟低**。然而，由于**缺乏一个标准的360◦视频质量评价方法**，很多文献只使用**图像质量指标**来评估**观众感知的质量**。

360◦视频比传统的2D视频应用程序**更个性化和交互式**，如Skype, PPlive ， CoolStreaming ， LiveSky，和YouTube。可扩展的360◦视频交付系统必须能够结合与广播分发的交互式实时内容生成和交付360◦视频内容的观众

- 交互式观看内容生产者的活动
- 选择在运行时的活动的视角。尽管目前的IPTV解决方案[64]-[67]为大规模传播提供了有效的框架

360◦视频内容交付系统，视频内容是由**地点**和**事件**关联的。

### （1）开发连贯性以实现高效的360视频传输

360视频的交付可以通过形成分布树来实现，该分布树将视频内容从源端传播到边缘服务器，以请求该视频。边缘服务器依次将视频段发送到下游客户端。树的节点是可以存储和发送视频段的CDN服务器。点播视频分布树的节点具有缓存和转发视频片段的能力。实时视频分布树的节点充当中继，并沿着树向下转发片段。这种体系结构有时称为**应用程序级多播**。

构造传统二维视频的分布树是一个深入研究的问题。在我们的研究中，我们通过解决一个优化问题来构建实时2-D视频的应用层组播树，以产生低成本和低丢包路径的视频传播。除了应用层组播之外，还有一些关键的建议可以为传统的2-D视频形成可扩展的ip级组播树，如基于核心的树和Mbone。构建360视频的分布树要复杂得多，因为要将整个高质量的360视频从源端传输到边缘服务器和客户端，需要大量的带宽。对于360视频传输来说，最坏的情况是每个用户都在以不同的和不可预测的质量水平观看不同的和不可预测的视点，但这种最坏的情况在实践中不太可能发生。事实上，观众可能会以如下方式在空间、时间、地点和行为上连贯地观看360个视频。

- **空间**一致性:它规定客户端的视口是由在空间上彼此相邻的贴图组成的。这意味着边缘服务器可以主动预取和缓存与下游客户端当前视口相邻的空间块。在视角更改的情况下，**创建新视图所需的tiles可能已经在近端边缘服务器的缓存中，这大大减少了延迟**。
- **时间**一致性:它规定了客户的视图可能会随着时间的推移以一种**可预测**的方式发展。例如，如果我们知道客户端视口中的轨迹，我们可以预测未来的运动，预取接下来需要的块，并将其存储在近端边缘服务器上，减少运动到光子的延迟
- **位置**一致性:它规定了**两个距离很近的客户**，例如，在体育场相邻的座位上，可能有相似的视角。在同一位置的客户端也可能有类似的连接，并需要相同视频质量的瓷砖，例如，在一个家里的两个客户端共享同一个连接到互联网。这样的位置一致性可以被用来减少网络上的流量。
- **行为**一致性:它指出，尽管客户在原则上可以以任意和不相关的方式观看360个视频，但他们的视角可能是非常相关的。在许多情况下，有一个**兴趣点**，大多数客户会关注。例如，在一场足球比赛中，当**球**在球场上移动时，大多数观众的眼睛可能会跟着它。使用电影的规则来限制客户的观看行为可能会增加这种一致性。如果可以预测的话，这种一致性也可以被利用来通过网络发送更少的流量。

利用这种查看一致性可以避免将所有质量的视频片段传输到边缘服务器上，并通过在需要之前只**预取需要的内容**来极大地**减少流量和延迟**。**360视频传输的主要挑战是如何(以及是否)以可扩展、准确和高效的方式利用这些相干性**，这是一个需要大量未来研究的课题。

### （2）最近的工作

最近研究360度视频的连贯性。只有一个视口的视频及其相邻的视频流到客户端，这可以导致高达65%的比特率节省。Zhou等人的评估表明，视角的突然变化会导致**未观看片段的检索浪费占总下载带宽的20%**。Bao等人针对全向360视频提出了一种基于运动的方法，他们证明了**用户对视区的选择是相关的**。这个知识可以用来发送多播流到**地理位置**上的观看者。

在下一代HMDs中，**凝视检测**是可能的，利用空间一致性变得更具挑战性，但更有回报。通过凝视检测，HDM可以提供准确的空间信息，可以精确定位客户端的焦点。人眼仅能在**大约20度的小中心视角**下看到丰富的图像，超过这个中心视角后，视力和颜色感知急剧下降，直到达到大约100的全视场。通过凝视检测，凝视信息将作为控制信息**从客户端流向上游边缘和分布树的节点**。一种大幅度减少流量的方法是将视频编码为多个分辨率和平铺大小，类似于为单视图视频提出的方法。小尺寸高分辨率瓷砖可以作为客户的中心视觉，大尺寸低分辨率瓷砖可以作为客户的周边视觉。



## 5. 经验

QoE多年来一直被用来评估观众在观看2d流媒体内容时的主观体验，但是无法衡量全景视频的质量。

ABR流媒体的日益流行导致了各种各样的QoE指标提议。

- 最近，ITU发布了一项建议，其中指定了HTTP自适应流媒体的质量评估。除了延迟对QoE的影响最为显著。视频流到客户端的平均质量，以及在播放期间质量变化的频率。
- 此外，已经有人努力将QoS映射到QoE，用于ABR流。速率自适应算法用于视频质量的评估。
- Singla等人给出了全向360视频的QoE和**晕屏结果**，但他们的评价**侧重于使用不同的HMDs**所造成的影响，没有考虑**视频创作和交付的影响**。
- Upenik等提出了一种**全方位内容主观评价的试验台**。目前，该试验台只允许对**全景静止图像进行评估**。虽然360视频已经存在几个数据集，但它们**并没有被用于评价QoE**，而是用于用户行为的建模。

在全景视频流的QoE领域需要更多的结构化研究，以更好地评估观众如何看待这些内容。这将需要一系列的主观评估，类似于在传统的二维视频中所做的评估。描述如何进行此类评估的标准，类似于电视图像的标准，将确保不同实体产生的评估结果具有可比性。这类研究也将受益于这类评估的试验台。

360视频流的QoE有**几个方面需要评估**。我们认为，应优先评估**影响晕屏的因素**，因为在普通屏幕上观看传统二维视频(与VR眼镜和眼镜相反)不会出现晕屏的影响。我们的假设是，通过**HMDs观看全方位360视频**引起的晕屏和**观看360视频时突然的场景变化**是影响QoE的两个重要因素。

未来研究的主要焦点是：对**晕屏原因**的调查。此外，还应研究**网络特性**(如延迟、抖动、可用带宽、视图/贴图退化率)和**流媒体特性**(如延迟、质量变化、视口变化)对晕屏病的影响。研究**生理症状**，如心率和呼吸频率是否与观看360个视频的观众的主观体验有关也很重要。还应评估根据电影摄影规则提供的观看指导对QoE的影响程度。如第三节所述，某些不符合电影规则的场景变化可能会导致观看不适，例如**中断连续观看和违反同步回放**。虽然过去已经进行了关于**相机切换**及其对QoE影响的研究，但这些研究都是非常初级的，需要进一步的研究来更好地理解两者之间的关系。最后，研究现实世界与网络世界的互动对QoE的影响。例如，在非栓系HMDs的情况下，用户将能够自由行走。此外，观众的**身体部分(如手、腿和脚)是看不见的**，这可能是另一个导致QoE降低和晕屏的因素。这将需要提供关于靠近观察者的物理对象的反馈机制。就AR和远程沉浸而言，我们还应该研究现实世界和网络世界之间的同步(或缺乏)对QoE的影响。

## 6. 总结

全向摄像头和终端设备，如VR头戴式设备OK。Not OK的三个主要方面:**内容创作、视频分发和QoE**。对于这些方面的每一个方面，我们都确定了主要的挑战和已经提出的现有方法。

- **专注于360视频特性的标准化QoE指标**还不存在。
- 在现有CDN架构的基础上，还没有设计**新的机制来满足360视频严格的延迟要求**。
- **无法将电影摄影规则融入内容创作技巧**

